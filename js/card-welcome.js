window.WELCOME_CONFIG={API_KEY:"i6Dsvkl8KMyG3XUvpvLxYStp3U",BLOG_LOCATION:{lng:113.19,lat:22.6},CACHE_DURATION:36e5,HOME_PAGE_ONLY:!0,SHOW_IP:!0,SHOW_DISTANCE:!0};const initWelcomeCard=()=>{if(WELCOME_CONFIG.HOME_PAGE_ONLY&&!isHomePage())return;const n=findWelcomeContainer();n&&(addWelcomeStyles(),showLoadingState(n),fetchIpInfo(n))},findWelcomeContainer=()=>{const n=document.getElementById("welcome-info");return n||(console.log("æœªæ‰¾åˆ°æ¬¢è¿ä¿¡æ¯å®¹å™¨"),null)},addWelcomeStyles=()=>{if(document.getElementById("welcome-card-styles"))return;const n=document.createElement("style");n.id="welcome-card-styles",n.textContent='\n        .card-welcome {\n            border-radius: var(--radius);\n            transition: all .3s;\n            overflow: hidden;\n            background: var(--efu-card-bg);\n            box-shadow: var(--efu-shadow-black);\n            border: var(--style-border);\n            user-select: none;\n        }\n        \n        .card-welcome .item-headline i {\n            color: #ff4757;\n        }\n        \n        .welcome-original {\n            margin-bottom: 20px;\n            line-height: 1.8;\n            color: var(--efu-fontcolor);\n        }\n\n        card-widget {\n          padding: 10px!important;\n         }\n\n        .welcome-original a {\n            color: var(--efu-main);\n            text-decoration: none;\n        }\n                        kbd {\n            display: inline-block;\n            color: #666;\n            font: bold 9pt arial;\n            text-decoration: none;\n            text-align: center;\n            padding: 2px 5px;\n            margin: 0 5px;\n            background: #eff0f2;\n            -moz-border-radius: 4px;\n            border-radius: 4px;\n            border-top: 1px solid #f5f5f5;\n            -webkit-box-shadow: inset 0 0 20px #e8e8e8, 0 1px 0 #c3c3c3, 0 1px 0 #c9c9c9, 0 1px 2px #333;\n            -moz-box-shadow: inset 0 0 20px #e8e8e8, 0 1px 0 #c3c3c3, 0 1px 0 #c9c9c9, 0 1px 2px #333;\n            -webkit-box-shadow: inset 0 0 20px #e8e8e8, 0 1px 0 #c3c3c3, 0 1px 0 #c9c9c9, 0 1px 2px #333;\n            -webkit-box-shadow: inset 0 0 20px #e8e8e8, 0 1px 0 #c3c3c3, 0 1px 0 #c9c9c9, 0 1px 2px #333;\n            box-shadow: inset 0 0 20px #e8e8e8, 0 1px 0 #c3c3c3, 0 1px 0 #c9c9c9, 0 1px 2px #333;\n            text-shadow: 0 1px 0 #f5f5f5;\n        }\n        .welcome-original a:hover {\n            text-decoration: underline;\n        }\n        \n        .welcome-ip-info {\n            margin-top: 15px;\n        }\n        \n        .ip-info-container {\n            background: #f0f2f5;\n            border-radius: 8px;\n            padding: 15px;\n            text-align: center;\n            line-height: 1.8;\n            color: var(--efu-fontcolor);\n            margin-top: 15px;\n        }\n        \n        [data-theme=dark] .ip-info-container {\n            background: #2a2d31;\n        }\n        \n        .ip-info-container b {\n            color: var(--efu-main);\n            font-weight: 600;\n        }\n        \n        .ip-info-container .location {\n            font-size: 16px;\n            margin-bottom: 8px;\n        }\n        \n        .ip-info-container .distance {\n            font-size: 14px;\n            margin-bottom: 8px;\n            opacity: 0.8;\n        }\n        \n        .ip-info-container .ip-address {\n            font-size: 14px;\n            margin-bottom: 12px;\n        }\n        \n        .ip-info-container .ip-address .ip-blur {\n            filter: blur(3px);\n            transition: filter 0.3s ease;\n            cursor: pointer;\n            color: var(--efu-main);\n        }\n        \n        .ip-info-container .ip-address .ip-blur:hover {\n            filter: blur(0);\n        }\n        \n        .ip-info-container .time-greeting {\n            font-size: 14px;\n            margin-bottom: 12px;\n        }\n        \n        .ip-info-container .greeting-tip {\n            font-size: 13px;\n            opacity: 0.8;\n            line-height: 1.6;\n        }\n        \n        .ip-info-container .greeting-tip .tip-content {\n            color: var(--efu-main);\n        }\n        \n        .loading-spinner {\n            width: 40px;\n            height: 40px;\n            border: 3px solid var(--efu-card-border);\n            border-radius: 50%;\n            border-top: 3px solid var(--efu-main);\n            animation: spin 1s linear infinite;\n        }\n        \n        @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n        }\n        \n        .error-message {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            gap: 12px;\n            color: var(--efu-red);\n        }\n        \n        .error-icon {\n            font-size: 2.5rem;\n            opacity: 0.7;\n        }\n        \n        .error-text {\n            font-size: 14px;\n            text-align: center;\n        }\n        \n        .retry-button {\n            color: var(--efu-main);\n            cursor: pointer;\n            transition: transform 0.3s ease;\n            font-size: 16px;\n        }\n        \n        .retry-button:hover {\n            transform: rotate(180deg);\n        }\n        \n        .permission-dialog {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            gap: 15px;\n        }\n        \n        .permission-dialog button {\n            margin: 5px;\n            padding: 8px 16px;\n            border: none;\n            border-radius: 6px;\n            background: var(--efu-main);\n            color: var(--efu-white);\n            cursor: pointer;\n            transition: all 0.3s ease;\n            font-size: 14px;\n        }\n        \n        .permission-dialog button:hover {\n            opacity: 0.8;\n            transform: translateY(-1px);\n        }\n        \n        .permission-dialog button[data-action="deny"] {\n            background: var(--efu-gray);\n        }\n    ',document.head.appendChild(n)},showLoadingState=n=>{n.innerHTML='<div class="loading-spinner"></div>'},fetchIpInfo=async n=>{try{const e=getCachedIpInfo();if(e)return void showWelcomeInfo(n,e);if(!checkLocationPermission())return void showPermissionDialog(n);const o=await fetch(`https://api.nsmao.net/api/ipip/query?key=${WELCOME_CONFIG.API_KEY}`);if(!o.ok)throw new Error("ç½‘ç»œè¯·æ±‚å¤±è´¥");const t=await o.json();cacheIpInfo(t),showWelcomeInfo(n,t)}catch(e){console.error("è·å–IPä¿¡æ¯å¤±è´¥:",e),showErrorMessage(n)}},showWelcomeInfo=(n,e)=>{if(!e||!e.data)return void showErrorMessage(n);const o=e.data,t=e.ip,i=WELCOME_CONFIG.SHOW_DISTANCE?calculateDistance(o.lng,o.lat):0,r=formatLocation(o.country,o.province,o.city),a=WELCOME_CONFIG.SHOW_IP?formatIpDisplay(t):"",c=getGreeting(o.country,o.province,o.city),s=`\n        <div class="ip-info-container">\n            <div class="location">\n                æ¬¢è¿æ¥è‡ª <b>${r}</b> çš„å°å‹ ğŸ’–\n            </div>\n            ${i>0?`<div class="distance">å½“å‰ä½ç½®è·åšä¸»çº¦ <b>${i}</b> å…¬é‡Œ</div>`:""}\n            ${a?`<div class="ip-address">${a}</div>`:""}\n            <div class="time-greeting">${getTimeGreeting()}</div>\n            <div class="greeting-tip">Tipï¼š<span class="tip-content">${c} ğŸ‚</span></div>\n        </div>\n    `;n.innerHTML=s},calculateDistance=(n,e)=>{if(!n||!e)return 0;const o=Math.PI/180,t=(e-WELCOME_CONFIG.BLOG_LOCATION.lat)*o,i=(n-WELCOME_CONFIG.BLOG_LOCATION.lng)*o,r=Math.sin(t/2)*Math.sin(t/2)+Math.cos(WELCOME_CONFIG.BLOG_LOCATION.lat*o)*Math.cos(e*o)*Math.sin(i/2)*Math.sin(i/2);return Math.round(12742*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))},formatLocation=(n,e,o)=>n?"ä¸­å›½"===n?e&&o?`${e} ${o}`:e||"ä¸­å›½":n:"ç¥ç§˜åœ°åŒº",formatIpDisplay=n=>{if(!n)return"";return`æ‚¨çš„IPåœ°å€ï¼š<span class="ip-blur">${n.includes(":")?"IPv6åœ°å€ (å¥½å¤æ‚ï¼Œå’±çœ‹ä¸æ‡‚~)":n}</span>`},getGreeting=(n,e,o)=>{const t={"ä¸­å›½":{"åŒ—äº¬å¸‚":"åŒ—â€”â€”äº¬â€”â€”æ¬¢è¿ä½ ~~~","å¤©æ´¥å¸‚":"è®²æ®µç›¸å£°å§","æ²³åŒ—çœ":"å±±åŠ¿å·å·æˆå£å’ï¼Œå¤©ä¸‹é›„å…³é“é©¬é‡‘æˆˆç”±æ­¤å‘ï¼Œæ— é™æ±Ÿå±±","å±±è¥¿çœ":"å±•å¼€åå…·é•¿ä¸‰å°ºï¼Œå·²å å±±æ²³äº”ç™¾ä½™","å†…è’™å¤è‡ªæ²»åŒº":"å¤©è‹è‹ï¼Œé‡èŒ«èŒ«ï¼Œé£å¹è‰ä½è§ç‰›ç¾Š","è¾½å®çœ":"æˆ‘æƒ³åƒçƒ¤é¸¡æ¶ï¼","å‰æ—çœ":"çŠ¶å…ƒé˜å°±æ˜¯ä¸œåŒ—çƒ§çƒ¤ä¹‹ç‹","é»‘é¾™æ±Ÿçœ":"å¾ˆå–œæ¬¢å“ˆå°”æ»¨å¤§å‰§é™¢","ä¸Šæµ·å¸‚":"ä¼—æ‰€å‘¨çŸ¥ï¼Œä¸­å›½åªæœ‰ä¸¤ä¸ªåŸå¸‚","æ±Ÿè‹çœ":{"å—äº¬å¸‚":"è¿™æ˜¯æˆ‘æŒºæƒ³å»çš„åŸå¸‚å•¦","è‹å·å¸‚":"ä¸Šæœ‰å¤©å ‚ï¼Œä¸‹æœ‰è‹æ­","å…¶ä»–":"æ•£è£…æ˜¯å¿…é¡»è¦æ•£è£…çš„"},"æµ™æ±Ÿçœ":{"æ­å·å¸‚":"ä¸œé£æ¸ç»¿è¥¿æ¹–æŸ³ï¼Œé›å·²è¿˜äººæœªå—å½’","å…¶ä»–":"æœ›æµ·æ¥¼æ˜ç…§æ›™éœ,æŠ¤æ±Ÿå ¤ç™½è¹‹æ™´æ²™"},"æ²³å—çœ":{"éƒ‘å·å¸‚":"è±«å·ä¹‹åŸŸï¼Œå¤©åœ°ä¹‹ä¸­","ä¿¡é˜³å¸‚":"å“ä¿¡é˜³æ¯›å°–ï¼Œæ‚Ÿäººé—´èŠ³å","å—é˜³å¸‚":"è‡£æœ¬å¸ƒè¡£ï¼Œèº¬è€•äºå—é˜³æ­¤å—é˜³éå½¼å—é˜³ï¼","é©»é©¬åº—å¸‚":"å³°å³°æœ‰å¥‡çŸ³ï¼ŒçŸ³çŸ³æŒŸä»™æ°”åµ–å²ˆå±±çš„èŠ±å¾ˆç¾å“¦ï¼","å¼€å°å¸‚":"åˆšæ­£ä¸é˜¿åŒ…é’å¤©","æ´›é˜³å¸‚":"æ´›é˜³ç‰¡ä¸¹ç”²å¤©ä¸‹","å…¶ä»–":"å¯å¦å¸¦æˆ‘å“å°æ²³å—çƒ©é¢å•¦ï¼Ÿ"},"å®‰å¾½çœ":"èšŒåŸ ä½äº†ï¼ŒèŠœæ¹–èµ·é£","ç¦å»ºçœ":"äº•é‚‘ç™½äº‘é—´ï¼Œå²©åŸè¿œå¸¦å±±","æ±Ÿè¥¿çœ":"è½éœä¸å­¤é¹œé½é£ï¼Œç§‹æ°´å…±é•¿å¤©ä¸€è‰²","å±±ä¸œçœ":"é¥æœ›é½å·ä¹ç‚¹çƒŸï¼Œä¸€æ³“æµ·æ°´æ¯ä¸­æ³»","æ¹–åŒ—çœ":{"é»„å†ˆå¸‚":"çº¢å®‰å°†å†›å¿ï¼è¾ˆå‡ºå°†æ‰ï¼","å…¶ä»–":"æ¥ç¢—çƒ­å¹²é¢~"},"æ¹–å—çœ":"74751ï¼Œé•¿æ²™æ–¯å¡”å…‹","å¹¿ä¸œçœ":{"å¹¿å·å¸‚":"çœ‹å°è›®è…°ï¼Œå–æ—©èŒ¶äº†å˜›~","æ·±åœ³å¸‚":"ä»Šå¤©ä½ é€›å•†åœºäº†å˜›~","é˜³æ±Ÿå¸‚":"é˜³æ˜¥åˆæ°´ï¼åšä¸»å®¶ä¹¡~ æ¬¢è¿æ¥ç©~","å…¶ä»–":"æ¥ä¸¤æ–¤ç¦å»ºäºº~"},"å¹¿è¥¿å£®æ—è‡ªæ²»åŒº":"æ¡‚æ—å±±æ°´ç”²å¤©ä¸‹","æµ·å—çœ":"æœè§‚æ—¥å‡ºé€ç™½æµªï¼Œå¤•çœ‹äº‘èµ·æ”¶éœå…‰","å››å·çœ":"åº·åº·å·å¦¹å­","è´µå·çœ":"èŒ…å°ï¼Œå­¦ç”Ÿï¼Œå†å¡200","äº‘å—çœ":"ç‰é¾™é£èˆäº‘ç¼ ç»•ï¼Œä¸‡ä»å†°å·ç›´è€¸å¤©","è¥¿è—è‡ªæ²»åŒº":"èººåœ¨èŒ«èŒ«è‰åŸä¸Šï¼Œä»°æœ›è“å¤©","é™•è¥¿çœ":"æ¥ä»½è‡Šå­é¢åŠ é¦","ç”˜è‚ƒçœ":"ç¾Œç¬›ä½•é¡»æ€¨æ¨æŸ³ï¼Œæ˜¥é£ä¸åº¦ç‰é—¨å…³","é’æµ·çœ":"ç‰›è‚‰å¹²å’Œè€é…¸å¥¶éƒ½å¥½å¥½åƒ","å®å¤å›æ—è‡ªæ²»åŒº":"å¤§æ¼ å­¤çƒŸç›´ï¼Œé•¿æ²³è½æ—¥åœ†","æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº":"é©¼é“ƒå¤é“ä¸ç»¸è·¯ï¼Œèƒ¡é©¬çŠ¹é—»å”æ±‰é£","å°æ¹¾çœ":"æˆ‘åœ¨è¿™å¤´ï¼Œå¤§é™†åœ¨é‚£å¤´","é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº":"æ°¸å®šè´¼æœ‰æ®‹ç•™åœ°é¬¼åšï¼Œè¿å‡»å…‰éå²ç‰","æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº":"æ€§æ„Ÿè·å®˜ï¼Œåœ¨çº¿å‘ç‰Œ","å…¶ä»–":"å¸¦æˆ‘å»ä½ çš„åŸå¸‚é€›é€›å§ï¼"},"ç¾å›½":"Let us live in peace!","æ—¥æœ¬":"ã‚ˆã‚ã—ãã€ä¸€ç·’ã«æ¡œã‚’è¦‹ã¾ã›ã‚“ã‹","ä¿„ç½—æ–¯":"å¹²äº†è¿™ç“¶ä¼ç‰¹åŠ ï¼","æ³•å›½":"C'est La Vie","å¾·å›½":"Die Zeit verging im Fluge.","æ¾³å¤§åˆ©äºš":"ä¸€èµ·å»å¤§å ¡ç¤å§ï¼","åŠ æ‹¿å¤§":"æ‹¾èµ·ä¸€ç‰‡æ«å¶èµ äºˆä½ ","å…¶ä»–":"å¸¦æˆ‘å»ä½ çš„å›½å®¶é€›é€›å§"};if(!n)return t["å…¶ä»–"];const i=t[n]||t["å…¶ä»–"];if("string"==typeof i)return i;if(e){const n=i[e]||i["å…¶ä»–"];return"string"==typeof n?n:o?n[o]||n["å…¶ä»–"]||i["å…¶ä»–"]:n["å…¶ä»–"]||i["å…¶ä»–"]}return i["å…¶ä»–"]||t["å…¶ä»–"]},getTimeGreeting=()=>{const n=(new Date).getHours();return n<11?"ğŸŒ¤ï¸ æ—©ä¸Šå¥½ï¼Œä¸€æ—¥ä¹‹è®¡åœ¨äºæ™¨":n<13?"â˜€ï¸ ä¸­åˆå¥½ï¼Œè®°å¾—åˆä¼‘å–”~":n<17?"ğŸ• ä¸‹åˆå¥½ï¼Œé¥®èŒ¶å…ˆå•¦ï¼":n<19?"ğŸš¶â€â™‚ï¸ å³å°†ä¸‹ç­ï¼Œè®°å¾—æŒ‰æ—¶åƒé¥­~":"ğŸŒ™ æ™šä¸Šå¥½ï¼Œå¤œç”Ÿæ´»å—¨èµ·æ¥ï¼"},showErrorMessage=n=>{n.innerHTML='\n        <div class="error-message">\n            <div class="error-icon">ğŸ˜•</div>\n            <div class="error-text">æŠ±æ­‰ï¼Œæ— æ³•è·å–ä¿¡æ¯</div>\n            <div class="error-text">è¯·<i class="retry-button solitude fas fa-arrows-rotate" onclick="retryFetchIpInfo()"></i>é‡è¯•æˆ–æ£€æŸ¥ç½‘ç»œè¿æ¥</div>\n        </div>\n    '},showPermissionDialog=n=>{n.innerHTML='\n        <div class="permission-dialog">\n            <div class="error-icon">â“</div>\n            <div class="error-text">æ˜¯å¦å…è®¸è®¿é—®æ‚¨çš„ä½ç½®ä¿¡æ¯ï¼Ÿ</div>\n            <div>\n                <button data-action="allow" onclick="handleLocationPermission(\'granted\')">å…è®¸</button>\n                <button data-action="deny" onclick="handleLocationPermission(\'denied\')">æ‹’ç»</button>\n            </div>\n        </div>\n    '},handleLocationPermission=n=>{if(localStorage.setItem("locationPermission",n),"granted"===n){const n=document.getElementById("welcome-info");n&&(showLoadingState(n),fetchIpInfo(n))}else{const n=document.getElementById("welcome-info");n&&(n.innerHTML='\n                <div class="error-message">\n                    <div class="error-icon">ğŸ”’</div>\n                    <div class="error-text">æ‚¨å·²æ‹’ç»è®¿é—®ä½ç½®ä¿¡æ¯</div>\n                </div>\n            ')}},checkLocationPermission=()=>"granted"===localStorage.getItem("locationPermission"),getCachedIpInfo=()=>{const n=localStorage.getItem("ip_info_cache");if(!n)return null;const{data:e,timestamp:o}=JSON.parse(n);return Date.now()-o>WELCOME_CONFIG.CACHE_DURATION?(localStorage.removeItem("ip_info_cache"),null):e},cacheIpInfo=n=>{localStorage.setItem("ip_info_cache",JSON.stringify({data:n,timestamp:Date.now()}))},retryFetchIpInfo=()=>{const n=document.getElementById("welcome-info");n&&(showLoadingState(n),fetchIpInfo(n))},isHomePage=()=>"/"===window.location.pathname||"/index.html"===window.location.pathname;document.addEventListener("DOMContentLoaded",initWelcomeCard),document.addEventListener("pjax:complete",initWelcomeCard);