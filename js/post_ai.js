class AIPostRenderer{static ANIMATION_DELAY_MS=40;static AI_EXPLANATION_SELECTOR=".ai-explanation";static AI_TAG_SELECTOR=".ai-tag";constructor(){this.startTextAnimation=this.startTextAnimation.bind(this),this.animationFrame=null,this.isDeleting=!1}init(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.initialize.bind(this)):this.initialize()}initialize(){this.cacheElements(),this.validateContent()&&this.renderAIContent()}cacheElements(){this.refs=new WeakMap,this.refs.set(document,{explanationElement:document.querySelector(AIPostRenderer.AI_EXPLANATION_SELECTOR),tagElement:document.querySelector(AIPostRenderer.AI_TAG_SELECTOR)});const{explanationElement:t,tagElement:e}=this.refs.get(document)||{};this.explanationElement=t,this.tagElement=e}validateContent(){return this.explanationElement&&this.tagElement&&this.aiContent.length&&!this.isAnimating}renderAIContent(){this.prepareAnimation(),setTimeout(()=>{this.explanationElement.style.display="block",this.explanationElement.classList.add("fast-blink"),this.animationFrame=requestAnimationFrame(()=>this.startTextAnimation(0))},3e3)}prepareAnimation(){this.isAnimating=!0,this.isDeleting=!0,this.tagElement.classList.add("loadingAI")}startTextAnimation(t){if(this.isDeleting){const e=this.explanationElement.textContent;e.length>0?(this.explanationElement.textContent=e.slice(0,-1),setTimeout(()=>{this.animationFrame=requestAnimationFrame(()=>this.startTextAnimation(t))},AIPostRenderer.ANIMATION_DELAY_MS)):(this.isDeleting=!1,this.startTextAnimation(0))}else t>=this.aiContent.length?this.completeAnimation():(this.explanationElement.textContent+=this.aiContent[t],setTimeout(()=>{this.animationFrame=requestAnimationFrame(()=>this.startTextAnimation(t+1))},AIPostRenderer.ANIMATION_DELAY_MS))}completeAnimation(){cancelAnimationFrame(this.animationFrame),this.isAnimating=!1,this.tagElement.classList.remove("loadingAI"),this.explanationElement.classList.remove("fast-blink");const t=new CustomEvent("aiRenderComplete",{detail:{element:this.explanationElement}});document.dispatchEvent(t)}get aiContent(){return PAGE_CONFIG?.ai_text||""}}const aiPostRenderer=(()=>{let t;return()=>(t||(t=new AIPostRenderer,t.init()),t)})(),ai=aiPostRenderer();